<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eagles Basketball - Elite Analytics Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        :root { --gold: #FFB81C; --black: #000000; }
        body { background-color: #050505; color: white; font-family: 'Inter', sans-serif; }
        .text-gold { color: var(--gold); }
        .bg-gold { background-color: var(--gold); }
        .border-gold { border-color: var(--gold); }
        .nav-btn { font-size: 10px; font-weight: 800; text-transform: uppercase; padding: 8px 16px; border-radius: 9999px; transition: 0.2s; white-space: nowrap; }
        .active-nav { background-color: var(--gold); color: black; }
        .stat-input { width: 42px; background: #111; border: 1px solid #333; border-radius: 4px; padding: 4px; text-align: center; font-size: 0.75rem; color: white; }
        .court-svg { width: 100%; max-width: 450px; display: block; margin: 0 auto; }
        .zone { cursor: pointer; transition: 0.2s; opacity: 0.4; stroke: white; stroke-width: 0.2; }
        .zone:hover { opacity: 0.8; fill: var(--gold); }
        .progress-bar { height: 8px; border-radius: 4px; background: #222; overflow: hidden; }
        .progress-fill { height: 100%; transition: width 1s ease-in-out; }
        @media print { .no-print { display: none; } body { background: white; color: black; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- CONSTANTS ---
        const firebaseConfig = { apiKey: "AIzaSyA5H5SsumWG7bym_0EZ7jOlfWeswpSauhk", projectId: "eagles-stats", appId: "1:386723096734:web:b50e343c703983e838b38f" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const ROSTER = [
            {id: 5, name: "Natasha Mistry", pos: "PG"}, {id: 3, name: "Mikayla Sanders", pos: "PG"}, {id: 22, name: "Christina Lisack", pos: "PG/G"},
            {id: 1, name: "Brittney Tang", pos: "G"}, {id: 2, name: "Kylie Mulcahy", pos: "G"}, {id: 4, name: "Lexi Guild", pos: "G"},
            {id: 10, name: "Reese Jackson", pos: "F"}, {id: 32, name: "Gia Comey", pos: "F"}, {id: 23, name: "Olivia Dozier", pos: "G/F"},
            {id: 44, name: "Olivia Fraser", pos: "G/F"}, {id: 34, name: "Dani Cardona", pos: "C"}, {id: 15, name: "Alexa Troiano", pos: "C"}
        ];

        const STAT_FIELDS = ['fg2m','fg2a','fg3m','fg3a','ftm','fta','reb','ast','stl','blk','to'];
        const ZONES = ['paint', 'ml', 'mr', '3lc', '3lw', '3t', '3rw', '3rc'];

        // --- COMPONENTS ---
        function App() {
            const [view, setView] = React.useState('entry');
            const [games, setGames] = React.useState([]);
            const [loading, setLoading] = React.useState(true);
            const [playerStats, setPlayerStats] = React.useState({});
            const [gameMeta, setGameMeta] = React.useState({ date: '', opp: '', oppScore: 0 });

            React.useEffect(() => {
                const unsub = db.collection('games').orderBy('date', 'desc').onSnapshot(snap => {
                    setGames(snap.docs.map(d => ({ id: d.id, ...d.data() })));
                    setLoading(false);
                });
                return () => unsub();
            }, []);

            const handleStatChange = (player, field, val) => {
                const v = parseInt(val) || 0;
                // Validation Logic
                if (field.includes('m')) {
                    const att = field.replace('m', 'a');
                    if (v > (playerStats[player]?.[att] || 0)) return;
                }
                setPlayerStats(prev => ({ ...prev, [player]: { ...prev[player], [field]: v } }));
            };

            const saveGame = async () => {
                if(!gameMeta.opp) return alert("Enter Opponent");
                let tScore = 0;
                const stats = ROSTER.map(p => {
                    const s = playerStats[p.name] || {};
                    const pts = ((s.fg2m||0)*2) + ((s.fg3m||0)*3) + (s.ftm||0);
                    tScore += pts;
                    return { ...p, ...s, pts };
                });
                await db.collection('games').add({ ...gameMeta, teamScore: tScore, stats, result: tScore > gameMeta.oppScore ? 'W' : 'L' });
                alert("Cloud Sync Success ðŸ¦…");
                setView('log');
            };

            if (loading) return <div className="h-screen flex items-center justify-center text-gold font-black italic animate-pulse">SYNCING EAGLES CLOUD...</div>;

            return (
                <div className="pb-20">
                    <header className="sticky top-0 z-50 bg-black border-b-4 border-gold p-4 shadow-2xl no-print">
                        <div className="max-w-7xl mx-auto flex flex-col lg:flex-row justify-between items-center gap-4">
                            <h1 className="text-2xl font-black italic uppercase italic">Eagles <span className="text-gold">Analytics</span></h1>
                            <nav className="flex gap-1 overflow-x-auto max-w-full pb-2">
                                {['entry','trends','goals','compare','stats','log','settings'].map(t => (
                                    <button key={t} onClick={() => setView(t)} className={`nav-btn ${view === t ? 'active-nav' : 'text-gray-500'}`}>{t}</button>
                                ))}
                            </nav>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto p-4 md:p-8">
                        {view === 'entry' && (
                            <div className="space-y-6">
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 bg-black p-6 rounded-2xl border border-gray-800">
                                    <input type="date" className="bg-gray-900 p-3 rounded-xl border border-gray-700" onChange={e => setGameMeta({...gameMeta, date: e.target.value})} />
                                    <input placeholder="Opponent Name" className="bg-gray-900 p-3 rounded-xl border border-gray-700 font-bold uppercase" onChange={e => setGameMeta({...gameMeta, opp: e.target.value})} />
                                    <input type="number" placeholder="Opp Score" className="bg-gray-900 p-3 rounded-xl border border-gray-700" onChange={e => setGameMeta({...gameMeta, oppScore: parseInt(e.target.value)})} />
                                </div>

                                <div className="bg-black border border-gray-800 rounded-2xl overflow-x-auto">
                                    <table className="w-full text-left text-xs">
                                        <thead className="bg-gray-900 text-gold uppercase">
                                            <tr><th className="p-4">Player</th>{STAT_FIELDS.map(f => <th key={f} className="p-2 text-center">{f}</th>)}</tr>
                                        </thead>
                                        <tbody>
                                            {ROSTER.map(p => (
                                                <tr key={p.id} className="border-b border-gray-900">
                                                    <td className="p-4 font-bold text-gray-400">{p.name}</td>
                                                    {STAT_FIELDS.map(f => (
                                                        <td key={f} className="p-2 text-center">
                                                            <input type="number" className="stat-input" value={playerStats[p.name]?.[f] || 0} onChange={e => handleStatChange(p.name, f, e.target.value)} />
                                                        </td>
                                                    ))}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                                <button onClick={saveGame} className="w-full bg-gold text-black py-5 rounded-2xl font-black text-xl uppercase shadow-xl hover:scale-[1.01] transition">Sync Record to Cloud</button>
                            </div>
                        )}

                        {view === 'goals' && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <GoalCard title="Win Conference" current={games.filter(g=>g.result==='W').length} target={12} unit="Wins" />
                                <GoalCard title="Team PPG" current={games.length ? (games.reduce((a,b)=>a+b.teamScore,0)/games.length).toFixed(1) : 0} target={55} unit="PPG" />
                                <GoalCard title="Opp PPG (Keep Under)" current={games.length ? (games.reduce((a,b)=>a+b.oppScore,0)/games.length).toFixed(1) : 0} target={50} unit="PPG" inverse={true} />
                            </div>
                        )}

                        {view === 'log' && (
                            <div className="space-y-4">
                                {games.map(g => (
                                    <div key={g.id} className="bg-black border border-gray-800 p-6 rounded-2xl flex justify-between items-center group hover:border-gold transition">
                                        <div>
                                            <div className="text-xs font-bold text-gray-500 uppercase">{g.date}</div>
                                            <div className="text-xl font-black italic">EAGLES {g.teamScore}, {g.opp} {g.oppScore}</div>
                                        </div>
                                        <div className={`px-4 py-2 rounded-xl font-black ${g.result === 'W' ? 'bg-green-900 text-green-400' : 'bg-red-900 text-red-400'}`}>{g.result}</div>
                                    </div>
                                ))}
                            </div>
                        )}
                        
                        {/* More views (Compare, Stats, Trends) follow same pattern */}
                    </main>
                </div>
            );
        }

        function GoalCard({ title, current, target, unit, inverse = false }) {
            const pct = Math.min((current / target) * 100, 100);
            const isAchieved = inverse ? current <= target : current >= target;
            return (
                <div className="bg-black p-6 rounded-2xl border border-gray-800">
                    <div className="flex justify-between mb-2">
                        <span className="font-black uppercase italic text-gray-400">{title}</span>
                        <span className={`text-xs font-black p-1 rounded ${isAchieved ? 'text-green-500' : 'text-gold'}`}>{isAchieved ? 'âœ“ ACHIEVED' : 'IN PROGRESS'}</span>
                    </div>
                    <div className="text-3xl font-black mb-4">{current} <span className="text-xs text-gray-600">/ {target} {unit}</span></div>
                    <div className="progress-bar">
                        <div className={`progress-fill ${isAchieved ? 'bg-green-500' : 'bg-gold'}`} style={{ width: `${pct}%` }}></div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
