<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eagles Basketball | Cloud Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        :root { --eagle-gold: #FFB81C; }
        .bg-gold { background-color: var(--eagle-gold); }
        .text-gold { color: var(--eagle-gold); }
        input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        
        .court-container { 
            position: relative; width: 100%; max-width: 480px; aspect-ratio: 50/47; 
            background: #0d0d0d; border: 2px solid #333; margin: 0 auto; border-radius: 12px; overflow: hidden;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
        }
        .court-line { position: absolute; background: rgba(255,255,255,0.15); pointer-events: none; }
        .baseline { bottom: 0; left: 0; width: 100%; height: 2px; }
        .the-key { bottom: 0; left: 50%; transform: translateX(-50%); width: 24%; height: 35%; border: 2px solid rgba(255,255,255,0.15); border-bottom: none; }
        .free-throw-circle { position: absolute; bottom: 23.5%; left: 50%; transform: translateX(-50%); width: 24%; aspect-ratio: 1; border: 2px solid rgba(255,255,255,0.15); border-radius: 50%; }
        
        /* Arc peaking perfectly at the top of the FT circle */
        .three-point-arc { 
            position: absolute; bottom: -35%; left: 7%; right: 7%; height: 70%; 
            border: 2px solid rgba(255,255,255,0.25); border-radius: 50%; pointer-events: none; 
        }
        .three-point-straight-l { bottom: 0; left: 7%; width: 2px; height: 12%; }
        .three-point-straight-r { bottom: 0; right: 7%; width: 2px; height: 12%; }
        .rim { bottom: 5%; left: 50%; transform: translateX(-50%); width: 6%; aspect-ratio: 1; border: 2px solid #e11d48; border-radius: 50%; position: absolute; }

        .court-zone { position: absolute; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: all 0.2s; border-radius: 8px; z-index: 20; }
        .zone-label { font-size: 8px; font-weight: 900; color: #555; text-transform: uppercase; margin-bottom: 2px; pointer-events: none; }
        .zone-input { width: 32px; font-size: 10px; background: black; border: 1px solid #444; color: white; text-align: center; border-radius: 3px; font-weight: bold; }

        /* Geographic Zone Placements */
        .z-paint { bottom: 5%; left: 32%; width: 36%; height: 30%; }
        .z-ml { bottom: 12%; left: 16%; width: 14%; height: 25%; }
        .z-mr { bottom: 12%; right: 16%; width: 14%; height: 25%; }
        .z-3lc { bottom: 2%; left: 0.5%; width: 6%; height: 15%; }
        .z-3rc { bottom: 2%; right: 0.5%; width: 6%; height: 15%; }
        .z-3lw { bottom: 32%; left: 1%; width: 12%; height: 25%; }
        .z-3rw { bottom: 32%; right: 1%; width: 12%; height: 25%; }
        .z-3t { bottom: 46%; left: 30%; width: 40%; height: 20%; }
        .log-card { background: #000; border: 1px solid #222; border-radius: 2.5rem; overflow: hidden; margin-bottom: 2rem; border-left: 8px solid var(--eagle-gold); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, addDoc, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";

        // --- PASTE YOUR CONFIG FROM STEP 4 HERE ---
        const firebaseConfig = {
            apiKey: "AIzaSyA5H5SsumWG7bym_0EZ7jOlfWeswpSauhk",
  authDomain: "eagles-stats.firebaseapp.com",
  projectId: "eagles-stats",
  storageBucket: "eagles-stats.firebasestorage.app",
  messagingSenderId: "386723096734",
  appId: "1:386723096734:web:b50e343c703983e838b38f",
  measurementId: "G-4SQEXFWE0W"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = "eagles-hq-v1";

        const ROSTER = [
            {id: 5, name: "Natasha Mistry", pos: "PG"}, {id: 3, name: "Mikayla Sanders", pos: "PG"},
            {id: 22, name: "Christina Lisack", pos: "PG/G"}, {id: 1, name: "Brittney Tang", pos: "G"},
            {id: 2, name: "Kylie Mulcahy", pos: "G"}, {id: 4, name: "Lexi Guild", pos: "G"},
            {id: 10, name: "Reese Jackson", pos: "F"}, {id: 32, name: "Gia Comey", pos: "F"},
            {id: 23, name: "Olivia Dozier", pos: "G/F"}, {id: 44, name: "Olivia Fraser", pos: "G/F"},
            {id: 34, name: "Dani Cardona", pos: "C"}, {id: 15, name: "Alexa Troiano", pos: "C"}
        ];

        const SHOT_ZONES = [
            { id: 'paint', label: 'Paint' }, { id: 'ml', label: 'Mid L' }, { id: 'mr', label: 'Mid R' },
            { id: '3lc', label: '3L Corner' }, { id: '3lw', label: '3L Wing' }, { id: '3t', label: '3 Top' },
            { id: '3rw', label: '3R Wing' }, { id: '3rc', label: '3R Corner' }
        ];

        function App() {
            const [view, setView] = React.useState('entry');
            const [games, setGames] = React.useState([]);
            const [loading, setLoading] = React.useState(true);
            const [opponent, setOpponent] = React.useState('');
            const [oppScore, setOppScore] = React.useState(0);
            const [playerStats, setPlayerStats] = React.useState({});
            const [shotMap, setShotMap] = React.useState({
                eagles: SHOT_ZONES.reduce((acc, z) => ({ ...acc, [z.id]: { m: 0, x: 0 } }), {}),
                opp: SHOT_ZONES.reduce((acc, z) => ({ ...acc, [z.id]: { m: 0, x: 0 } }), {})
            });

            React.useEffect(() => {
                signInAnonymously(auth);
                return onAuthStateChanged(auth, (user) => {
                    if (user) {
                        const q = collection(db, 'artifacts', appId, 'public', 'data', 'games');
                        onSnapshot(q, (snapshot) => {
                            setGames(snapshot.docs.map(d => ({ id: d.id, ...d.data() })).sort((a,b) => new Date(b.date) - new Date(a.date)));
                            setLoading(false);
                        });
                    }
                });
            }, []);

            const saveGame = async () => {
                if (!opponent) return alert("Enter Opponent Name");
                let teamPts = 0;
                const stats = ROSTER.map(p => {
                    const s = playerStats[p.name] || {};
                    const pts = (s.fg2m||0)*2 + (s.fg3m||0)*3 + (s.ftm||0);
                    teamPts += pts;
                    return { ...p, ...s, pts };
                });
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'games'), {
                    date: new Date().toLocaleDateString(),
                    opp: opponent, oppScore, teamScore: teamPts, 
                    result: teamPts > oppScore ? 'W' : 'L',
                    stats, shotMap
                });
                alert("Synced!"); setOpponent(''); setPlayerStats({}); setView('log');
            };

            if (loading) return <div className="h-screen bg-black flex items-center justify-center text-gold font-black italic">SYNCING CLOUD...</div>;

            return (
                <div className="min-h-screen bg-gray-950 text-white font-sans">
                    <header className="bg-black border-b-4 border-gold p-6 flex justify-between items-center sticky top-0 z-50">
                        <h1 className="text-2xl font-black italic uppercase">Eagles <span className="text-gold">Cloud</span></h1>
                        <nav className="flex gap-2">
                            {['entry', 'log', 'clipboard'].map(v => (
                                <button key={v} onClick={() => setView(v)} className={`px-4 py-1 rounded-full text-[10px] font-black uppercase ${view === v ? 'bg-gold text-black' : 'text-gray-500'}`}>{v}</button>
                            ))}
                        </nav>
                    </header>

                    <div className="max-w-7xl mx-auto p-4 md:p-8">
                        {view === 'entry' && (
                            <div className="space-y-8">
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="bg-black p-4 rounded-xl border border-gray-800"><label className="text-[10px] text-gold uppercase font-black block mb-1">Opponent</label><input type="text" value={opponent} onChange={e => setOpponent(e.target.value)} className="w-full bg-transparent outline-none font-bold uppercase" placeholder="NAME" /></div>
                                    <div className="bg-black p-4 rounded-xl border border-gray-800"><label className="text-[10px] text-red-500 uppercase font-black block mb-1">Score</label><input type="number" value={oppScore} onChange={e => setOppScore(e.target.value)} className="w-full bg-transparent outline-none font-black text-xl" /></div>
                                </div>
                                <div className="bg-black border border-gray-800 rounded-3xl overflow-x-auto">
                                    <table className="w-full text-left text-xs">
                                        <thead className="bg-gray-900 text-gold uppercase">
                                            <tr><th className="p-4 sticky left-0 bg-gray-900">Player</th><th>2PM</th><th>2PA</th><th>3PM</th><th>3PA</th><th>FTM</th><th>FTA</th><th>REB</th><th>AST</th></tr>
                                        </thead>
                                        <tbody>
                                            {ROSTER.map(p => (
                                                <tr key={p.id} className="border-b border-gray-900">
                                                    <td className="p-3 font-bold sticky left-0 bg-black">{p.name}</td>
                                                    {['fg2m','fg2a','fg3m','fg3a','ftm','fta','reb','ast'].map(f => (
                                                        <td key={f} className="p-1"><input type="number" className="w-10 bg-gray-900 border border-gray-800 rounded p-1 text-center font-bold" onChange={e => setPlayerStats({...playerStats, [p.name]: {...playerStats[p.name], [f]: parseInt(e.target.value)||0}})} /></td>
                                                    ))}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                    <div className="bg-black p-6 rounded-3xl border border-gray-800">
                                        <p className="text-center text-[10px] uppercase font-black mb-4">Eagles Shot Map</p>
                                        <div className="court-container">
                                            <div className="court-line baseline"></div><div className="court-line the-key"></div><div className="court-line free-throw-circle"></div><div className="court-line three-point-straight-l"></div><div className="court-line three-point-straight-r"></div><div className="three-point-arc"></div><div className="rim"></div>
                                            {SHOT_ZONES.map(z => <div key={z.id} className={`court-zone z-${z.id}`}>
                                                <span className="zone-label">{z.label}</span>
                                                <div className="flex gap-1">
                                                    <input type="number" className="zone-input" onChange={e => {
                                                        const nm = {...shotMap}; nm.eagles[z.id].m = parseInt(e.target.value)||0; setShotMap(nm);
                                                    }} />
                                                    <input type="number" className="zone-input" onChange={e => {
                                                        const nm = {...shotMap}; nm.eagles[z.id].x = parseInt(e.target.value)||0; setShotMap(nm);
                                                    }} />
                                                </div>
                                            </div>)}
                                        </div>
                                    </div>
                                    <div className="bg-black p-6 rounded-3xl border border-gray-800">
                                        <p className="text-center text-[10px] uppercase font-black mb-4 text-red-500">Opponent Shot Map</p>
                                        <div className="court-container border-red-900/40">
                                            <div className="court-line baseline"></div><div className="court-line the-key"></div><div className="court-line free-throw-circle"></div><div className="court-line three-point-straight-l"></div><div className="court-line three-point-straight-r"></div><div className="three-point-arc"></div><div className="rim"></div>
                                            {SHOT_ZONES.map(z => <div key={z.id} className={`court-zone z-${z.id}`}>
                                                <span className="zone-label">{z.label}</span>
                                                <div className="flex gap-1">
                                                    <input type="number" className="zone-input" onChange={e => {
                                                        const nm = {...shotMap}; nm.opp[z.id].m = parseInt(e.target.value)||0; setShotMap(nm);
                                                    }} />
                                                    <input type="number" className="zone-input" onChange={e => {
                                                        const nm = {...shotMap}; nm.opp[z.id].x = parseInt(e.target.value)||0; setShotMap(nm);
                                                    }} />
                                                </div>
                                            </div>)}
                                        </div>
                                    </div>
                                </div>
                                <button onClick={saveGame} className="w-full bg-gold text-black py-8 rounded-3xl font-black text-3xl uppercase shadow-2xl">Sync to Cloud</button>
                            </div>
                        )}

                        {view === 'log' && (
                            <div className="space-y-6">
                                {games.map(g => (
                                    <div key={g.id} className="log-card p-10 flex flex-col md:flex-row justify-between items-center gap-10">
                                        <div><p className="text-gold text-[10px] font-black uppercase mb-2 tracking-widest">{g.date}</p><p className="log-score-text uppercase">Eagles {g.teamScore}, {g.opp} {g.oppScore}</p></div>
                                        <button onClick={() => deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'games', g.id))} className="text-red-500 border border-red-900 p-4 rounded-xl hover:bg-red-900 hover:text-white transition-all"><Trash2 size={24} /></button>
                                    </div>
                                ))}
                            </div>
                        )}

                        {view === 'clipboard' && (
                            <div className="space-y-8 animate-fadeIn">
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                    <div className="clipboard-card">
                                        <h3 className="text-lg font-black uppercase italic mb-4 text-gold border-b border-gray-900 pb-2">Top 3 Scorers</h3>
                                        {ROSTER.map(p => ({
                                            name: p.name,
                                            pts: games.reduce((acc, g) => acc + (g.stats.find(s => s.name === p.name)?.pts || 0), 0)
                                        })).sort((a,b) => b.pts - a.pts).slice(0,3).map((p, i) => (
                                            <div key={i} className="flex justify-between p-2 mb-1 rounded bg-gray-900 border border-gray-800"><span className="text-xs font-bold">{p.name}</span><span className="font-black text-gold">{p.pts}</span></div>
                                        ))}
                                    </div>
                                    <div className="clipboard-card">
                                        <h3 className="text-lg font-black uppercase italic mb-4 text-white border-b border-gray-900 pb-2">Top 3 Boards</h3>
                                        {ROSTER.map(p => ({
                                            name: p.name,
                                            reb: games.reduce((acc, g) => acc + (g.stats.find(s => s.name === p.name)?.reb || 0), 0)
                                        })).sort((a,b) => b.reb - a.reb).slice(0,3).map((p, i) => (
                                            <div key={i} className="flex justify-between p-2 mb-1 rounded bg-gray-900 border border-gray-800"><span className="text-xs font-bold">{p.name}</span><span className="font-black text-white">{p.reb}</span></div>
                                        ))}
                                    </div>
                                    <div className="clipboard-card">
                                        <h3 className="text-lg font-black uppercase italic mb-4 text-gold border-b border-gray-900 pb-2">Top 3 FT%</h3>
                                        {ROSTER.map(p => {
                                            const m = games.reduce((acc, g) => acc + (g.stats.find(s => s.name === p.name)?.ftm || 0), 0);
                                            const a = games.reduce((acc, g) => acc + (g.stats.find(s => s.name === p.name)?.fta || 0), 0);
                                            return { name: p.name, m, a, pct: a > 0 ? (m/a)*100 : 0 };
                                        }).filter(p => p.a > 0).sort((a,b) => b.pct - a.pct).slice(0,3).map((p, i) => (
                                            <div key={i} className="flex justify-between p-2 mb-1 rounded bg-gray-900 border border-gray-800"><span className="text-xs font-bold">{p.name}</span><span className="font-black text-gold">{p.pct.toFixed(0)}%</span></div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
