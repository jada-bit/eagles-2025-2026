<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eagles Girls Basketball Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Firebase Compat SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        :root { --eagle-gold: #FFB81C; --eagle-black: #000000; }
        .bg-gold { background-color: var(--eagle-gold); }
        .text-gold { color: var(--eagle-gold); }
        .border-gold { border-color: var(--eagle-gold); }
        input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        
        .stat-input { width: 45px; background: #111; border: 1px solid #333; border-radius: 4px; padding: 4px; text-align: center; color: white; font-size: 0.8rem; }
        .stat-input:focus { border-color: var(--eagle-gold); outline: none; background: #222; }
        
        .sticky-col { position: sticky; left: 0; background-color: #000; z-index: 10; border-right: 2px solid #333; }
        
        .nav-btn { font-size: 10px; font-weight: 800; text-transform: uppercase; padding: 8px 16px; border-radius: 9999px; transition: all 0.2s; white-space: nowrap; }
        .active-nav { background-color: var(--eagle-gold); color: black; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .inactive-nav { color: #9ca3af; }
        .inactive-nav:hover { color: white; }
        
        .clipboard-card { background: #0a0a0a; border: 1px solid #222; border-top: 4px solid var(--eagle-gold); }
        .profile-stat-box { background: #111; border: 1px solid #222; padding: 1rem; border-radius: 0.75rem; text-align: center; }
        .modal-overlay { background: rgba(0,0,0,0.9); backdrop-filter: blur(4px); }
        
        .court-container { 
            position: relative; width: 100%; max-width: 500px; aspect-ratio: 50/47; 
            background: #0d0d0d; border: 2px solid #333; margin: 0 auto; border-radius: 8px; overflow: hidden;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
        }
        .court-line { position: absolute; background: rgba(255,255,255,0.15); pointer-events: none; }
        .baseline { bottom: 0; left: 0; width: 100%; height: 2px; }
        .the-key { bottom: 0; left: 50%; transform: translateX(-50%); width: 24%; height: 30%; border: 2px solid rgba(255,255,255,0.15); border-bottom: none; }
        .free-throw-circle { position: absolute; bottom: calc(42% - 24%); left: 50%; transform: translateX(-50%); width: 24%; aspect-ratio: 1; border: 2px solid rgba(255,255,255,0.15); border-radius: 50%; }
        .three-point-arc { position: absolute; bottom: -42%; left: 7%; right: 7%; height: 84%; border: 2px solid rgba(255,255,255,0.15); border-radius: 50%; pointer-events: none; }
        .rim { bottom: 5%; left: 50%; transform: translateX(-50%); width: 6%; aspect-ratio: 1; border: 2px solid #e11d48; border-radius: 50%; position: absolute; }

        .court-zone { position: absolute; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: all 0.2s; border-radius: 8px; z-index: 20; cursor: pointer; }
        .court-zone:hover { background: rgba(255, 184, 28, 0.1); outline: 1px solid var(--eagle-gold); }
        .zone-label { font-size: 8px; font-weight: 900; color: #555; text-transform: uppercase; margin-bottom: 2px; pointer-events: none; }
        .zone-input-group { display: flex; gap: 2px; align-items: center; }
        .zone-input { width: 40px; height: 40px; font-size: 11px; background: black; border: 1px solid #444; color: white; text-align: center; border-radius: 3px; padding: 1px 0; font-weight: bold; }
        
        .z-paint { bottom: 5%; left: 32%; width: 36%; height: 35%; }
        .z-mid-l { bottom: 12%; left: 14%; width: 16%; height: 25%; }
        .z-mid-r { bottom: 12%; right: 14%; width: 16%; height: 25%; }
        .z-3-lc { bottom: 2%; left: 0.5%; width: 6%; height: 15%; }
        .z-3-rc { bottom: 2%; right: 0.5%; width: 6%; height: 15%; }
        .z-3-lw { bottom: 35%; left: 1%; width: 12%; height: 30%; }
        .z-3-rw { bottom: 35%; right: 1%; width: 12%; height: 30%; }
        .z-3-t { top: 5%; left: 25%; width: 50%; height: 25%; }

        .log-card { background: #000; border: 1px solid #222; border-radius: 2rem; overflow: hidden; margin-bottom: 1.5rem; transition: all 0.3s; border-left: 10px solid var(--eagle-gold); }
        .log-score { font-size: 2.5rem; font-weight: 900; font-style: italic; letter-spacing: -0.05em; line-height: 1; }
        .log-result-box { width: 4.5rem; height: 4.5rem; border-radius: 1.25rem; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: 900; }
        
        .alert-badge { display: inline-block; padding: 0.5rem 1rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 800; text-transform: uppercase; }
        .alert-warning { background: #7c2d12; color: #fca5a5; border: 1px solid #991b1b; }
        .alert-success { background: #14532d; color: #86efac; border: 1px solid #166534; }
        
        .progress-bar { height: 8px; background: #1f2937; border-radius: 999px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--eagle-gold); transition: width 0.3s; }
        
        .heat-zone { transition: all 0.2s; }
        .heat-elite { background: rgba(34, 197, 94, 0.3) !important; border: 1px solid #22c55e !important; }
        .heat-good { background: rgba(59, 130, 246, 0.2) !important; border: 1px solid #3b82f6 !important; }
        .heat-avg { background: rgba(251, 191, 36, 0.2) !important; border: 1px solid #fbbf24 !important; }
        .heat-poor { background: rgba(239, 68, 68, 0.3) !important; border: 1px solid #ef4444 !important; }
    </style>
</head>
<body class="bg-gray-950 text-white font-sans min-h-screen">

    <div id="loading-screen" class="fixed inset-0 z-[200] bg-black flex flex-col items-center justify-center">
        <div class="text-white text-6xl mb-4 italic font-black uppercase tracking-tighter">EAGLES <span class="text-gold">HQ</span></div>
        <div class="text-gold text-lg font-black animate-pulse uppercase italic tracking-widest">Connecting to Cloud...</div>
    </div>

    <div class="max-w-7xl mx-auto pb-20">
        <header class="sticky top-0 z-50 bg-black border-b-4 border-gold p-4 md:p-6 shadow-2xl">
            <div class="flex flex-col lg:flex-row justify-between items-center gap-6">
                <div class="flex items-center gap-4">
                    <div class="bg-white w-12 h-12 rounded-full flex items-center justify-center border-2 border-gold shadow-lg transform -rotate-2"><span class="text-2xl">ðŸ¦…</span></div>
                    <div>
                        <h1 class="text-3xl font-black italic uppercase tracking-tighter leading-none">Eagles <span class="text-gold">Dashboard</span></h1>
                        <p class="text-[9px] text-gray-500 uppercase tracking-widest mt-1 font-bold">Championship Analytics Hub</p>
                    </div>
                </div>
                <nav class="flex flex-wrap justify-center gap-1 bg-gray-900 p-1 rounded-full border border-gray-800 overflow-x-auto max-w-full">
                    <button onclick="toggleView('entry')" id="nav-entry" class="nav-btn active-nav">New Game</button>
                    <button onclick="toggleView('trends')" id="nav-trends" class="nav-btn inactive-nav">Trends</button>
                    <button onclick="toggleView('tactics')" id="nav-tactics" class="nav-btn inactive-nav">Tactics</button>
                    <button onclick="toggleView('defense')" id="nav-defense" class="nav-btn inactive-nav">Defense</button>
                    <button onclick="toggleView('scouting')" id="nav-scouting" class="nav-btn inactive-nav">Scouting</button>
                    <button onclick="toggleView('clipboard')" id="nav-clipboard" class="nav-btn inactive-nav">Clipboard</button>
                    <button onclick="toggleView('goals')" id="nav-goals" class="nav-btn inactive-nav">Goals</button>
                    <button onclick="toggleView('summary')" id="nav-summary" class="nav-btn inactive-nav">Season Stats</button>
                    <button onclick="toggleView('compare')" id="nav-compare" class="nav-btn inactive-nav">Compare</button>
                    <button onclick="toggleView('log')" id="nav-log" class="nav-btn inactive-nav">Log</button>
                    <button onclick="toggleView('profiles')" id="nav-profiles" class="nav-btn inactive-nav">Profiles</button>
                    <button onclick="toggleView('settings')" id="nav-settings" class="nav-btn inactive-nav">Settings</button>
                </nav>
            </div>
        </header>

        <!-- NEW GAME -->
        <main id="view-entry" class="p-4 md:p-8 animate-fadeIn">
            <div class="bg-black border border-gray-800 rounded-2xl shadow-2xl overflow-hidden mb-8">
                <div class="p-6 grid grid-cols-1 md:grid-cols-5 gap-4 bg-gray-900 border-b border-gray-800">
                    <div><label class="text-[10px] text-gold font-bold uppercase tracking-widest">Date</label><input type="date" id="gameDate" class="w-full bg-black border border-gray-700 p-3 rounded-lg text-white outline-none focus:border-gold"></div>
                    <div><label class="text-[10px] text-gold font-bold uppercase tracking-widest">Opponent</label><input type="text" id="opponent" placeholder="Enter Opponent" class="w-full bg-black border border-gray-700 p-3 rounded-lg text-white outline-none focus:border-gold uppercase font-bold"></div>
                    <div><label class="text-[10px] text-red-500 font-bold uppercase tracking-widest">Opp Score</label><input type="number" id="oppScore" placeholder="Score" class="w-full bg-black border border-gray-700 p-3 rounded-lg text-white outline-none focus:border-red-500 font-black live-calc"></div>
                    <div><label class="text-[10px] text-gold font-bold uppercase tracking-widest">Venue</label><select id="venue" class="w-full bg-black border border-gray-700 p-3 rounded-lg text-white outline-none focus:border-gold"><option value="Home">Home</option><option value="Away">Away</option><option value="Neutral">Neutral</option></select></div>
                    <div><label class="text-[10px] text-gold font-bold uppercase tracking-widest">Game Type</label><select id="gameType" class="w-full bg-black border border-gray-700 p-3 rounded-lg text-white outline-none focus:border-gold"><option value="Regular">Regular</option><option value="Playoffs">Playoffs</option><option value="Tournament">Tournament</option></select></div>
                </div>
                
                <!-- Quarter Scoring -->
                <div class="p-6 bg-gray-950 border-b border-gray-800">
                    <h3 class="text-xs font-black uppercase text-gold mb-4">Quarter-by-Quarter</h3>
                    <div class="grid grid-cols-4 gap-4">
                        <div><label class="text-[9px] text-gray-500 uppercase">Q1 Eagles</label><input type="number" id="q1Eagles" class="w-full bg-black border border-gray-700 p-2 rounded text-white text-sm live-calc" value="0"></div>
                        <div><label class="text-[9px] text-gray-500 uppercase">Q2 Eagles</label><input type="number" id="q2Eagles" class="w-full bg-black border border-gray-700 p-2 rounded text-white text-sm live-calc" value="0"></div>
                        <div><label class="text-[9px] text-gray-500 uppercase">Q3 Eagles</label><input type="number" id="q3Eagles" class="w-full bg-black border border-gray-700 p-2 rounded text-white text-sm live-calc" value="0"></div>
                        <div><label class="text-[9px] text-gray-500 uppercase">Q4 Eagles</label><input type="number" id="q4Eagles" class="w-full bg-black border border-gray-700 p-2 rounded text-white text-sm live-calc" value="0"></div>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead><tr class="bg-gray-950 text-gold text-[9px] uppercase border-b border-gray-800"><th class="p-4 sticky-col">Player</th><th class="p-2 text-center">MIN</th><th class="p-2 text-center">2PM</th><th class="p-2 text-center">2PA</th><th class="p-2 text-center">3PM</th><th class="p-2 text-center">3PA</th><th class="p-2 text-center">FTM</th><th class="p-2 text-center">FTA</th><th class="p-2 text-center">OREB</th><th class="p-2 text-center">DREB</th><th class="p-2 text-center">AST</th><th class="p-2 text-center">STL</th><th class="p-2 text-center">BLK</th><th class="p-2 text-center">TO</th><th class="p-2 text-center">PF</th></tr></thead>
                        <tbody id="rosterRows"></tbody>
                    </table>
                </div>
            </div>
            
            <div class="grid grid-cols-1 xl:grid-cols-2 gap-8 mb-8">
                <div class="bg-black border border-gray-800 rounded-2xl p-8 shadow-xl flex flex-col">
                    <h3 class="text-xl font-black uppercase italic text-gold mb-4">Set Play Tracker</h3>
                    <div id="setPlayInputs" class="space-y-3"></div>
                    <button onclick="addSetPlayInput()" class="mt-6 text-[10px] uppercase font-black bg-gray-900 border border-gray-800 text-gold px-6 py-3 rounded-xl hover:bg-gold hover:text-black transition-all">+ New Set Play</button>
                </div>
                
                <div class="bg-gold text-black rounded-3xl p-8 shadow-2xl text-center flex flex-col justify-center border-b-8 border-black/20">
                    <h3 class="text-xl font-black uppercase italic mb-6">Live Snapshot</h3>
                    <div class="grid grid-cols-2 gap-8">
                        <div><div class="text-[10px] font-black uppercase opacity-60">Eagles</div><div class="text-5xl font-black tracking-tighter" id="liveEaglesTotal">0</div><div class="text-sm font-black" id="liveEaglesFG">0/0 (0.0%)</div></div>
                        <div><div class="text-[10px] font-black uppercase opacity-60">Opponent</div><div class="text-5xl font-black tracking-tighter" id="liveOppTotal">0</div></div>
                    </div>
                </div>
            </div>
            
            <!-- Game Notes -->
            <div class="bg-black border border-gray-800 rounded-2xl p-6 mb-8">
                <h3 class="text-sm font-black uppercase text-gold mb-4">Game Notes & Context</h3>
                <textarea id="gameNotes" rows="3" placeholder="Injuries, key plays, observations..." class="w-full bg-gray-950 border border-gray-700 p-4 rounded-lg text-white outline-none focus:border-gold text-sm"></textarea>
            </div>
            
            <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                <div class="bg-black border border-gray-800 rounded-2xl p-8 shadow-xl text-center">
                    <h4 class="text-sm font-black uppercase text-gold mb-4">Eagles Shot Chart</h4>
                    <div class="court-container" id="eaglesShotMapInput">
                        <div class="court-line baseline"></div><div class="court-line the-key"></div><div class="court-line free-throw-circle"></div><div class="three-point-arc"></div><div class="rim"></div>
                        <div class="court-zone z-paint"><span class="zone-label">Paint</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="paint" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="paint" data-type="x" value="0"></div></div>
                        <div class="court-zone z-3-lc"><span class="zone-label">3L CRN</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="3lc" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="3lc" data-type="x" value="0"></div></div>
                        <div class="court-zone z-3-rc"><span class="zone-label">3R CRN</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="3rc" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="3rc" data-type="x" value="0"></div></div>
                        <div class="court-zone z-3-lw"><span class="zone-label">3L WNG</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="3lw" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="3lw" data-type="x" value="0"></div></div>
                        <div class="court-zone z-3-rw"><span class="zone-label">3R WNG</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="3rw" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="3rw" data-type="x" value="0"></div></div>
                        <div class="court-zone z-3-t"><span class="zone-label">3 Top</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="3t" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="3t" data-type="x" value="0"></div></div>
                        <div class="court-zone z-mid-l"><span class="zone-label">Mid L</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="ml" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="ml" data-type="x" value="0"></div></div>
                        <div class="court-zone z-mid-r"><span class="zone-label">Mid R</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="mr" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="eagles" data-zone="mr" data-type="x" value="0"></div></div>
                    </div>
                </div>
                <div class="bg-black border border-gray-800 rounded-2xl p-8 shadow-xl text-center">
                    <h4 class="text-sm font-black uppercase text-red-500 mb-4">Opponent Shot Chart</h4>
                    <div class="court-container border-red-900/40" id="oppShotMapInput">
                        <div class="court-line baseline"></div><div class="court-line the-key"></div><div class="court-line free-throw-circle"></div><div class="three-point-arc"></div><div class="rim"></div>
                        <div class="court-zone z-paint"><span class="zone-label text-red-900">Paint</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="opp" data-zone="paint" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="opp" data-zone="paint" data-type="x" value="0"></div></div>
                        <div class="court-zone z-3-lc"><span class="zone-label text-red-900">3L CRN</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="opp" data-zone="3lc" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="opp" data-zone="3lc" data-type="x" value="0"></div></div>
                        <div class="court-zone z-3-rc"><span class="zone-label text-red-900">3R CRN</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="opp" data-zone="3rc" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="opp" data-zone="3rc" data-type="x" value="0"></div></div>
                        <div class="court-zone z-3-lw"><span class="zone-label text-red-900">3L WNG</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="opp" data-zone="3lw" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="opp" data-zone="3lw" data-type="x" value="0"></div></div>
                        <div class="court-zone z-3-rw"><span class="zone-label text-red-900">3R WNG</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="opp" data-zone="3rw" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="opp" data-zone="3rw" data-type="x" value="0"></div></div>
                        <div class="court-zone z-3-t"><span class="zone-label text-red-900">3 Top</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="opp" data-zone="3t" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="opp" data-zone="3t" data-type="x" value="0"></div></div>
                        <div class="court-zone z-mid-l"><span class="zone-label text-red-900">Mid L</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="opp" data-zone="ml" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="opp" data-zone="ml" data-type="x" value="0"></div></div>
                        <div class="court-zone z-mid-r"><span class="zone-label text-red-900">Mid R</span><div class="zone-input-group"><input type="number" class="zone-input live-calc" data-team="opp" data-zone="mr" data-type="m" value="0"><span>/</span><input type="number" class="zone-input live-calc" data-team="opp" data-zone="mr" data-type="x" value="0"></div></div>
                    </div>
                </div>
            </div>
            <div class="mt-12 text-center"><button onclick="saveGameToCloud()" class="bg-gold text-black px-24 py-6 rounded-2xl font-black text-2xl uppercase shadow-2xl hover:scale-105 ring-4 ring-gold/20">Sync Record to Cloud</button></div>
        </main>

        <!-- TRENDS VIEW -->
        <main id="view-trends" class="hidden p-4 md:p-8 space-y-8">
            <h2 class="text-3xl font-black text-gold uppercase italic mb-6">Performance Trends</h2>
            
            <div id="performanceAlerts" class="mb-8"></div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-black border border-gray-800 rounded-2xl p-6">
                    <h3 class="text-sm font-black uppercase text-gold mb-4">Scoring Trend</h3>
                    <canvas id="scoringTrendChart"></canvas>
                </div>
                <div class="bg-black border border-gray-800 rounded-2xl p-6">
                    <h3 class="text-sm font-black uppercase text-gold mb-4">Field Goal %</h3>
                    <canvas id="fgPctTrendChart"></canvas>
                </div>
                <div class="bg-black border border-gray-800 rounded-2xl p-6">
                    <h3 class="text-sm font-black uppercase text-gold mb-4">3-Point %</h3>
                    <canvas id="threePctTrendChart"></canvas>
                </div>
                <div class="bg-black border border-gray-800 rounded-2xl p-6">
                    <h3 class="text-sm font-black uppercase text-gold mb-4">Turnover Trend</h3>
                    <canvas id="toTrendChart"></canvas>
                </div>
            </div>
            
            <div class="bg-black border border-gray-800 rounded-2xl p-8">
                <h3 class="text-lg font-black uppercase text-gold mb-6">Quarter Analysis</h3>
                <canvas id="quarterChart"></canvas>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-black border border-gray-800 rounded-2xl p-8">
