<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eagles Analytics - Tactical Command</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        :root { --gold: #FFB81C; --black: #050505; --red: #ef4444; --green: #22c55e; --blue: #3b82f6; }
        body { background-color: var(--black); color: white; font-family: system-ui, -apple-system, sans-serif; }
        
        .bento-card { 
            background: rgba(25, 25, 25, 0.85); 
            border: 1px solid rgba(255, 255, 255, 0.08); 
            border-radius: 16px; 
            padding: 1.25rem; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .nav-btn { font-size: 11px; font-weight: 800; text-transform: uppercase; padding: 10px 16px; border-radius: 99px; cursor: pointer; border: 1px solid transparent; transition: all 0.2s; }
        .active-nav { background-color: var(--gold); color: black; box-shadow: 0 0 15px rgba(255, 184, 28, 0.3); }
        .inactive-nav { background: rgba(255,255,255,0.05); color: #888; }
        .inactive-nav:hover { background: rgba(255,255,255,0.1); color: white; }

        .court-svg { width: 100%; display: block; margin: 0 auto; touch-action: manipulation; filter: drop-shadow(0 0 8px rgba(255,184,28,0.1)); }
        .zone { cursor: pointer; transition: 0.2s; opacity: 0.3; stroke: rgba(255,255,255,0.4); stroke-width: 0.8; fill: transparent; }
        .zone:hover { opacity: 0.6; stroke: white; }
        
        .stat-input { background: #111; border: 1px solid #333; color: white; padding: 4px; text-align: center; border-radius: 6px; width: 100%; font-weight: bold; }
        
        .alert-box { animation: slideIn 0.3s ease-out; border-left: 4px solid; padding: 12px; margin-bottom: 8px; background: rgba(255,255,255,0.03); border-radius: 0 8px 8px 0; }
        .alert-good { border-color: var(--green); } .alert-bad { border-color: var(--red); }
        @keyframes slideIn { from { transform: translateX(-10px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        /* Tactical Table Styles */
        .tac-row { display: grid; grid-template-columns: 3fr 1fr 1fr 1fr; gap: 8px; padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.05); align-items: center; }
        .tac-head { font-size: 10px; font-weight: 900; color: #666; text-transform: uppercase; padding-bottom: 4px; }
    </style>
</head>
<body>
    <div id="root">
        <div style="height: 100vh; display: flex; align-items: center; justify-content: center; color: #FFB81C; font-weight: bold; font-size: 24px; animation: pulse 2s infinite;">
            LOADING TACTICS...
        </div>
    </div>

    <script type="text/babel">
        // --- CONFIG ---
        const ROSTER = [
            {id: 5, name: "Natasha Mistry", pos: "PG"}, {id: 3, name: "Mikayla Sanders", pos: "PG"}, 
            {id: 22, name: "Christina Lisack", pos: "PG/G"}, {id: 1, name: "Brittney Tang", pos: "G"},
            {id: 2, name: "Kylie Mulcahy", pos: "G"}, {id: 4, name: "Lexi Guild", pos: "G"},
            {id: 10, name: "Reese Jackson", pos: "F"}, {id: 32, name: "Gia Comey", pos: "F"}, 
            {id: 23, name: "Olivia Dozier", pos: "G/F"}, {id: 44, name: "Olivia Fraser", pos: "G/F"},
            {id: 34, name: "Dani Cardona", pos: "C"}, {id: 15, name: "Alexa Troiano", pos: "C"},
            {id: 0, name: "Bela Smith", pos: "G/F"}
        ];
        const ZONES = ['paint', 'mid_l', 'mid_r', 'mid_c', 'corn_l', 'corn_r', 'wing_l', 'wing_r', 'top'];
        const STAT_FIELDS = ['fg2m','fg2a','fg3m','fg3a','ftm','fta','reb','ast','stl','to'];

        // --- APP ---
        function App() {
            // -- CORE STATE --
            const [view, setView] = React.useState('clipboard');
            const [games, setGames] = React.useState([]);
            const [loading, setLoading] = React.useState(true);
            const [db, setDb] = React.useState(null);

            // -- DATA ENTRY STATE --
            const [gameMeta, setGameMeta] = React.useState({ date: new Date().toISOString().split('T')[0], opp: '', oppScore: 0, venue: 'Home' });
            const [playerStats, setPlayerStats] = React.useState({});
            const [shotMap, setShotMap] = React.useState({ eagles: ZONES.reduce((a,z)=>({...a,[z]:{m:0,x:0}}), {}), opp: {} });
            const [playStats, setPlayStats] = React.useState([
                { id: 'trans', name: 'TRANSITION', att: 0, made: 0, pts: 0 },
                { id: 'broken', name: 'BROKEN PLAY', att: 0, made: 0, pts: 0 },
                { id: 'motion', name: 'Motion Offense', att: 0, made: 0, pts: 0 }
            ]);
            const [newPlayName, setNewPlayName] = React.useState('');
            const [shotMode, setShotMode] = React.useState('make');
            const [editId, setEditId] = React.useState(null);

            // -- TACTICS FILTER STATE --
            const [tacticsFilter, setTacticsFilter] = React.useState('season'); // 'season' or gameId

            // -- INITIALIZATION --
            React.useEffect(() => {
                try {
                    const firebaseConfig = { apiKey: "AIzaSyA5H5SsumWG7bym_0EZ7jOlfWeswpSauhk", projectId: "eagles-stats", appId: "1:386723096734:web:b50e343c703983e838b38f" };
                    if(window.firebase && !firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
                    const d = firebase.firestore();
                    setDb(d);
                    d.collection('games').orderBy('date', 'desc').onSnapshot(snap => {
                        setGames(snap.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                        setLoading(false);
                    });
                } catch(e) { console.warn("Offline"); setLoading(false); }
            }, []);

            // -- HELPERS --
            const getTacticalData = () => {
                let targetGames = games;
                if (tacticsFilter !== 'season') targetGames = games.filter(g => g.id === tacticsFilter);

                // Aggregate Plays
                const aggPlays = {};
                targetGames.forEach(g => {
                    if(g.playStats) {
                        g.playStats.forEach(p => {
                            if(!aggPlays[p.name]) aggPlays[p.name] = { name: p.name, att: 0, made: 0, pts: 0 };
                            aggPlays[p.name].att += (p.att || 0);
                            aggPlays[p.name].made += (p.made || 0);
                            aggPlays[p.name].pts += (p.pts || (p.made*2) || 0); // Fallback logic
                        });
                    }
                });

                // Aggregate Shot Map
                const aggMap = ZONES.reduce((a,z)=>({...a,[z]:{m:0,x:0}}), {});
                targetGames.forEach(g => {
                    if(g.shotMap && g.shotMap.eagles) {
                        ZONES.forEach(z => {
                            const zone = g.shotMap.eagles[z] || {m:0, x:0};
                            aggMap[z].m += zone.m;
                            aggMap[z].x += zone.x;
                        });
                    }
                });

                return { plays: Object.values(aggPlays), map: aggMap };
            };

            const handlePlayUpdate = (index, points) => {
                const newPlays = [...playStats];
                newPlays[index].att += 1;
                if (points > 0) {
                    newPlays[index].made += 1;
                    newPlays[index].pts += points;
                }
                setPlayStats(newPlays);
            };

            const saveGame = async () => {
                if(!db) return alert("Offline Mode");
                if(!gameMeta.opp) return alert("Need Opponent Name");
                let tScore = 0;
                const stats = ROSTER.map(p => {
                    const s = playerStats[p.name] || {};
                    const pts = ((s.fg2m||0)*2)+((s.fg3m||0)*3)+(s.ftm||0);
                    tScore += pts;
                    return { ...p, ...s, pts };
                });
                const payload = { ...gameMeta, teamScore: tScore, stats, shotMap, playStats, result: tScore>gameMeta.oppScore?'W':'L', updatedAt: firebase.firestore.FieldValue.serverTimestamp() };
                try {
                    if(editId) await db.collection('games').doc(editId).update(payload);
                    else await db.collection('games').add(payload);
                    alert("Tactical Data Saved"); setEditId(null); setView('tactics');
                } catch(e) { alert("Error: "+e.message); }
            };

            if(loading) return <div className="p-20 text-center text-gold font-bold">LOADING...</div>;

            // -- RENDER --
            const tacticalData = getTacticalData();

            return (
                <div className="pb-24 max-w-7xl mx-auto p-4">
                    {/* NAV HEADER */}
                    <div className="flex justify-between items-center mb-6 bg-zinc-900 p-4 rounded-xl border border-white/10">
                        <h1 className="text-xl font-black italic uppercase">Eagles <span className="text-gold">Tactics</span></h1>
                        <nav className="flex gap-2">
                            {['clipboard', 'new', 'tactics', 'trends', 'log'].map(t => (
                                <button key={t} onClick={()=>setView(t)} className={`nav-btn ${view===t?'active-nav':'inactive-nav'}`}>{t}</button>
                            ))}
                        </nav>
                    </div>

                    {/* VIEW: TACTICS (NEW) */}
                    {view === 'tactics' && (
                        <div className="space-y-6 animate-slideIn">
                            {/* Filter Bar */}
                            <div className="flex justify-between items-center bg-zinc-900 p-3 rounded-lg border border-zinc-800">
                                <label className="text-xs font-bold text-zinc-500 uppercase mr-3">Data Source:</label>
                                <select className="bg-black text-white font-bold text-xs p-2 rounded border border-zinc-700 flex-1" value={tacticsFilter} onChange={e=>setTacticsFilter(e.target.value)}>
                                    <option value="season">FULL SEASON AGGREGATE</option>
                                    <optgroup label="Single Games">
                                        {games.map(g => <option key={g.id} value={g.id}>{g.date} vs {g.opp} ({g.result})</option>)}
                                    </optgroup>
                                </select>
                            </div>

                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                {/* 1. PLAY EFFICIENCY TABLE */}
                                <div className="bento-card h-full">
                                    <h3 className="text-xl font-black text-gold uppercase italic mb-4">Set Play Efficiency</h3>
                                    <div className="tac-row bg-zinc-900/50 border-none rounded mb-2">
                                        <div className="tac-head">Play Name</div>
                                        <div className="tac-head text-center">Poss</div>
                                        <div className="tac-head text-center">Score %</div>
                                        <div className="tac-head text-right text-gold">PPP</div>
                                    </div>
                                    <div className="space-y-1">
                                        {tacticalData.plays.sort((a,b)=>((b.pts/b.att)||-1)-((a.pts/a.att)||-1)).map((p, i) => {
                                            const ppp = p.att > 0 ? (p.pts / p.att).toFixed(2) : '0.00';
                                            const pct = p.att > 0 ? Math.round((p.made/p.att)*100) : 0;
                                            return (
                                                <div key={i} className="tac-row hover:bg-white/5 transition">
                                                    <div className="font-bold text-sm">{p.name}</div>
                                                    <div className="text-center font-mono text-zinc-400">{p.att}</div>
                                                    <div className={`text-center font-bold text-xs ${pct>=50?'text-green-500':(pct<30?'text-red-500':'text-blue-400')}`}>{pct}%</div>
                                                    <div className="text-right font-black text-gold text-lg">{ppp}</div>
                                                </div>
                                            );
                                        })}
                                        {tacticalData.plays.length === 0 && <div className="text-center text-zinc-600 py-10 text-xs uppercase">No Play Data Found</div>}
                                    </div>
                                </div>

                                {/* 2. ENHANCED HEAT MAP */}
                                <div className="bento-card">
                                    <div className="flex justify-between items-center mb-6">
                                        <h3 className="text-xl font-black text-gold uppercase italic">Shot Heat Map</h3>
                                        <div className="text-[9px] font-bold text-zinc-500 text-right uppercase">
                                            <span className="text-green-500">● 50%+</span> <span className="text-blue-500 ml-1">● 40%</span> <span className="text-yellow-500 ml-1">● 30%</span> <span className="text-red-500 ml-1">● &lt;30%</span>
                                        </div>
                                    </div>
                                    <HeatMapCourt data={tacticalData.map} />
                                    <div className="mt-4 text-center">
                                        <div className="inline-block bg-zinc-900 px-4 py-2 rounded-lg border border-zinc-800">
                                            <div className="text-[9px] font-bold text-zinc-500 uppercase tracking-widest mb-1">Total eFG% (This View)</div>
                                            <div className="text-2xl font-black text-white italic">
                                                {(() => {
                                                    let m=0, x=0;
                                                    Object.values(tacticalData.map).forEach(z=>{m+=z.m; x+=z.x;});
                                                    return (m+x)>0 ? Math.round((m/(m+x))*100) + '%' : '-';
                                                })()}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* VIEW: NEW GAME (UPDATED INPUTS) */}
                    {view === 'new' && (
                        <div className="space-y-6 animate-slideIn">
                             {/* META INPUTS */}
                             <div className="bento-card grid grid-cols-2 md:grid-cols-4 gap-4">
                                <div className="space-y-1"><label className="text-[9px] font-bold uppercase text-zinc-500">Opponent</label><input className="w-full bg-black border border-zinc-700 p-2 rounded text-white font-bold" value={gameMeta.opp} onChange={e=>setGameMeta({...gameMeta, opp:e.target.value})}/></div>
                                <div className="space-y-1"><label className="text-[9px] font-bold uppercase text-zinc-500">Opp Score</label><input type="number" className="w-full bg-black border border-zinc-700 p-2 rounded text-white font-bold" value={gameMeta.oppScore} onChange={e=>setGameMeta({...gameMeta, oppScore:parseInt(e.target.value)||0})}/></div>
                                <div className="space-y-1"><label className="text-[9px] font-bold uppercase text-zinc-500">Date</label><input type="date" className="w-full bg-black border border-zinc-700 p-2 rounded text-white font-bold" value={gameMeta.date} onChange={e=>setGameMeta({...gameMeta, date:e.target.value})}/></div>
                                <div className="space-y-1"><label className="text-[9px] font-bold uppercase text-zinc-500">Venue</label><select className="w-full bg-black border border-zinc-700 p-2 rounded text-white font-bold" value={gameMeta.venue} onChange={e=>setGameMeta({...gameMeta, venue:e.target.value})}><option>Home</option><option>Away</option></select></div>
                            </div>

                            <div className="grid grid-cols-1 lg:grid-cols-12 gap-6">
                                {/* PLAYBOOK INPUT */}
                                <div className="lg:col-span-5 bento-card border-t-4 border-gold">
                                    <h3 className="font-black text-gold uppercase mb-4">Playbook Input</h3>
                                    <div className="space-y-3">
                                        {playStats.map((p, i) => (
                                            <div key={i} className="bg-zinc-900/50 p-3 rounded-xl border border-white/5 flex flex-col gap-2">
                                                <div className="flex justify-between items-center">
                                                    <span className="font-bold text-sm uppercase">{p.name}</span>
                                                    <span className="text-[10px] font-mono text-zinc-500">{(p.pts/(p.att||1)).toFixed(2)} PPP</span>
                                                </div>
                                                <div className="grid grid-cols-3 gap-2">
                                                    <button onClick={()=>handlePlayUpdate(i,0)} className="bg-zinc-800 text-zinc-400 hover:bg-red-900/50 hover:text-red-200 py-2 rounded text-[10px] font-black uppercase tracking-widest border border-zinc-700">Stop</button>
                                                    <button onClick={()=>handlePlayUpdate(i,2)} className="bg-zinc-800 text-zinc-400 hover:bg-blue-900/50 hover:text-blue-200 py-2 rounded text-[10px] font-black uppercase tracking-widest border border-zinc-700">+2 Pts</button>
                                                    <button onClick={()=>handlePlayUpdate(i,3)} className="bg-zinc-800 text-zinc-400 hover:bg-green-900/50 hover:text-green-200 py-2 rounded text-[10px] font-black uppercase tracking-widest border border-zinc-700">+3 Pts</button>
                                                </div>
                                            </div>
                                        ))}
                                        <div className="flex gap-2 pt-2"><input className="bg-black border border-zinc-700 rounded p-2 text-xs flex-1 text-white font-bold" placeholder="New Play..." value={newPlayName} onChange={e=>setNewPlayName(e.target.value)} /><button onClick={()=>{if(newPlayName){setPlayStats([...playStats,{id:Date.now(),name:newPlayName,att:0,made:0,pts:0}]);setNewPlayName('');}}} className="bg-gold text-black font-bold text-xs px-3 rounded uppercase">Add</button></div>
                                    </div>
                                </div>

                                {/* SHOT CHART INPUT */}
                                <div className="lg:col-span-7 bento-card">
                                    <div className="flex justify-between mb-4"><h3 className="font-black text-gold uppercase">Shot Input</h3><div className="flex bg-black rounded border border-zinc-800 p-1"><button onClick={()=>setShotMode('make')} className={`px-3 py-1 text-[10px] font-black uppercase rounded ${shotMode==='make'?'bg-green-600 text-white':'text-zinc-500'}`}>Make</button><button onClick={()=>setShotMode('miss')} className={`px-3 py-1 text-[10px] font-black uppercase rounded ${shotMode==='miss'?'bg-red-600 text-white':'text-zinc-500'}`}>Miss</button></div></div>
                                    <InteractiveCourt data={shotMap.eagles} mode={shotMode} onClick={(z,m)=>{const c=shotMap.eagles[z]||{m:0,x:0};setShotMap({...shotMap,eagles:{...shotMap.eagles,[z]:{m:c.m+(m?1:0),x:c.x+(m?0:1)}}})}} />
                                    {/* Quick Stats Grid */}
                                    <div className="mt-6 overflow-x-auto"><table className="w-full text-xs"><thead><tr className="text-zinc-500 border-b border-zinc-800"><th className="p-2 text-left">PLAYER</th>{STAT_FIELDS.map(f=><th key={f} className="p-1 uppercase text-center">{f.replace('fg','').replace('m','')}</th>)}<th className="p-2 text-gold text-right">PTS</th></tr></thead><tbody>{ROSTER.map(p=>{const s=playerStats[p.name]||{};return(<tr key={p.id} className="border-b border-white/5"><td className="p-2 font-bold whitespace-nowrap">{p.name}</td>{STAT_FIELDS.map(f=><td key={f} className="p-1"><input type="number" className="stat-input" value={s[f]||''} onChange={e=>setPlayerStats({...playerStats,[p.name]:{...s,[f]:parseInt(e.target.value)||0}})}/></td>)}<td className="p-2 text-gold font-bold text-right">{((s.fg2m||0)*2)+((s.fg3m||0)*3)+(s.ftm||0)}</td></tr>)})}</tbody></table></div>
                                </div>
                            </div>
                            <button onClick={saveGame} className="w-full py-4 bg-gold hover:bg-white text-black font-black uppercase text-xl rounded-xl shadow-lg transition-all">Save Game Log</button>
                        </div>
                    )}

                    {/* OTHER VIEWS (Simplified for this version) */}
                    {view === 'clipboard' && <div className="text-center py-20 text-zinc-500 uppercase font-black">Dashboard View (See Pro Version for full Analytics)</div>}
                    {view === 'trends' && <div className="text-center py-20 text-zinc-500 uppercase font-black">Trends View (See Pro Version for Charts)</div>}
                    {view === 'log' && <div className="grid gap-4">{games.map(g=><div key={g.id} className="bento-card flex justify-between items-center"><div><div className="text-xs font-bold text-zinc-500">{g.date}</div><div className="text-xl font-black italic">{g.result} vs {g.opp}</div></div><button onClick={()=>{setEditId(g.id);setGameMeta({date:g.date,opp:g.opp,oppScore:g.oppScore,venue:g.venue});setPlayStats(g.playStats||[]);const sm={};g.stats.forEach(s=>sm[s.name]=s);setPlayerStats(sm);setShotMap(g.shotMap);setView('new');}} className="bg-zinc-800 text-xs font-bold uppercase p-2 rounded">Edit</button></div>)}</div>}
                </div>
            );
        }

        // --- SUB COMPONENTS ---
        function InteractiveCourt({ data, onClick, mode }) {
            const getFill = (key) => { const z=data[key]||{m:0,x:0}, t=z.m+z.x; if(t===0) return 'transparent'; return (z.m/t)>=0.4?'rgba(34,197,94,0.6)':'rgba(239,68,68,0.6)'; };
            return (<div className="relative max-w-[350px] mx-auto select-none"><svg viewBox="0 0 100 94" className="court-svg"><rect width="100" height="94" fill="#111" stroke="#333"/><path d="M 35,94 L 35,55 L 65,55 L 65,94 Z" className="zone" fill={getFill('paint')} onClick={()=>onClick('paint',mode==='make')}/><path d="M 10,94 L 10,15 Q 50,-15 90,15 L 90,94" fill="none" stroke="#555" strokeWidth="1" strokeDasharray="4,4" pointerEvents="none"/><path d="M 10,55 L 35,55 L 35,94 L 10,94 Z" className="zone" onClick={()=>onClick('mid_l',mode==='make')} fill={getFill('mid_l')}/><path d="M 65,55 L 90,55 L 90,94 L 65,94 Z" className="zone" onClick={()=>onClick('mid_r',mode==='make')} fill={getFill('mid_r')}/><path d="M 35,55 L 35,30 L 65,30 L 65,55 Z" className="zone" onClick={()=>onClick('mid_c',mode==='make')} fill={getFill('mid_c')}/><path d="M 0,94 L 0,60 L 10,60 L 10,94 Z" className="zone" onClick={()=>onClick('corn_l',mode==='make')} fill={getFill('corn_l')}/><path d="M 90,94 L 90,60 L 100,60 L 100,94 Z" className="zone" onClick={()=>onClick('corn_r',mode==='make')} fill={getFill('corn_r')}/><path d="M 0,60 L 0,0 L 30,0 L 35,30 L 10,55 Z" className="zone" onClick={()=>onClick('wing_l',mode==='make')} fill={getFill('wing_l')}/><path d="M 100,60 L 100,0 L 70,0 L 65,30 L 90,55 Z" className="zone" onClick={()=>onClick('wing_r',mode==='make')} fill={getFill('wing_r')}/><path d="M 30,0 L 70,0 L 65,30 L 35,30 Z" className="zone" onClick={()=>onClick('top',mode==='make')} fill={getFill('top')}/><text x="50" y="85" className="zone-label" fill="white" fontSize="4">PAINT</text></svg></div>);
        }

        // --- NEW: 4-COLOR HEAT MAP ---
        function HeatMapCourt({ data }) {
            const getFill = (key) => { 
                const z = data[key] || {m:0,x:0}, t = z.m+z.x; 
                if(t === 0) return 'rgba(255,255,255,0.05)'; 
                const pct = z.m/t;
                if(pct >= 0.5) return 'rgba(34, 197, 94, 0.7)'; // Elite (Green)
                if(pct >= 0.4) return 'rgba(59, 130, 246, 0.7)'; // Good (Blue)
                if(pct >= 0.3) return 'rgba(234, 179, 8, 0.7)';  // Avg (Yellow)
                return 'rgba(239, 68, 68, 0.7)';                 // Poor (Red)
            };
            return (
                <div className="relative max-w-[350px] mx-auto select-none">
                    <svg viewBox="0 0 100 94" className="court-svg">
                        <rect width="100" height="94" fill="#000" stroke="#333"/>
                        {/* 4-Color Logic Applied Here */}
                        <path d="M 35,94 L 35,55 L 65,55 L 65,94 Z" fill={getFill('paint')} stroke="black" strokeWidth="0.5" />
                        <path d="M 10,94 L 10,15 Q 50,-15 90,15 L 90,94" fill="none" stroke="#444" strokeWidth="1" strokeDasharray="4,4" />
                        <path d="M 10,55 L 35,55 L 35,94 L 10,94 Z" fill={getFill('mid_l')} stroke="black" strokeWidth="0.5"/>
                        <path d="M 65,55 L 90,55 L 90,94 L 65,94 Z" fill={getFill('mid_r')} stroke="black" strokeWidth="0.5"/>
                        <path d="M 35,55 L 35,30 L 65,30 L 65,55 Z" fill={getFill('mid_c')} stroke="black" strokeWidth="0.5"/>
                        <path d="M 0,94 L 0,60 L 10,60 L 10,94 Z" fill={getFill('corn_l')} stroke="black" strokeWidth="0.5"/>
                        <path d="M 90,94 L 90,60 L 100,60 L 100,94 Z" fill={getFill('corn_r')} stroke="black" strokeWidth="0.5"/>
                        <path d="M 0,60 L 0,0 L 30,0 L 35,30 L 10,55 Z" fill={getFill('wing_l')} stroke="black" strokeWidth="0.5"/>
                        <path d="M 100,60 L 100,0 L 70,0 L 65,30 L 90,55 Z" fill={getFill('wing_r')} stroke="black" strokeWidth="0.5"/>
                        <path d="M 30,0 L 70,0 L 65,30 L 35,30 Z" fill={getFill('top')} stroke="black" strokeWidth="0.5"/>
                        
                        {/* Overlay Text for Percentages */}
                        {ZONES.map(z => {
                             const d = data[z] || {m:0,x:0}, t = d.m+d.x;
                             if(t<1) return null;
                             const pct = Math.round((d.m/t)*100);
                             const pos = { paint:[50,80], mid_l:[22,75], mid_r:[78,75], mid_c:[50,45], corn_l:[5,80], corn_r:[95,80], wing_l:[15,30], wing_r:[85,30], top:[50,20] }[z];
                             if(!pos) return null;
                             return <text key={z} x={pos[0]} y={pos[1]} fill="white" fontSize="3" fontWeight="900" textAnchor="middle">{pct}%</text>
                        })}
                    </svg>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
